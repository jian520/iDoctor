{"version":3,"sources":["../lib/SGListView.js"],"names":["PrivateMethods","captureReferenceFor","cellData","sectionId","rowId","row","undefined","updateCellsVisibility","visibleRows","changedRows","section","hasOwnProperty","currentSection","currentCell","currentCellVisibility","setVisibility","calculateDimensionsForCell","childFrames","sectionID","rowID","horizontal","index","Error","cell","x","y","width","viewProperties","height","length","childFrame","updateCellsPremptively","props","premptiveLoading","premptiveLoadedCells","firstVisibleRow","lastVisibleRow","firstVisibleSection","lastVisibleSection","Number","i","indexOf","splice","isScrollingUp","isScrollingDown","scrollDirectionChanged","lastScrollDirection","pop","push","SGListView","createClass","propTypes","renderScrollComponent","PropTypes","func","number","getDefaultProps","componentWillMount","onChangeVisibleRows","onScroll","e","OS","dataSource","allRowIDs","rowIdentities","idx","sectionIdx","sectionIdentities","rowIDs","renderSectionHeader","rowIdx","ex","getNativeListView","_updateVisibleRows","refs","nativeListView","getScrollResponder","component","renderRow","rowData","highlightRowFunc","view","sectionData","sectionHeaderSupplied","render","module","exports"],"mappings":"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","file":"SGListView.js","sourcesContent":["import React, { PropTypes } from 'react';\nimport { ListView, ScrollView, Platform } from 'react-native';\nimport SGListViewCell from './SGListViewCell';\n\n/**\n * Some methods are stored here. The benefit of doing so are:\n * 1. The methods are truly private from the outside (unliked the _methodName pattern)\n * 2. The methods aren't instantiated with every instance\n * 3. They're static and hold 0 state\n * 4. Keeps the class size smaller\n */\nconst PrivateMethods = {\n  captureReferenceFor(cellData, sectionId, rowId, row) {\n    if (cellData[sectionId] === undefined) {\n      cellData[sectionId] = {};\n    }\n\n    cellData[sectionId][rowId] = row; // Capture the reference\n  },\n\n  /**\n   * Go through the changed rows and update the cell with their new visibility state\n   */\n  updateCellsVisibility(cellData, visibleRows, changedRows) {\n    // update changed rows\n    for (const section in changedRows) {\n      if (changedRows.hasOwnProperty(section)) { // Good JS hygiene check\n        const currentSection = changedRows[section];\n\n        for (const row in currentSection) {\n          if (currentSection.hasOwnProperty(row)) { // Good JS hygiene check\n            const currentCell = cellData[section][row];\n            const currentCellVisibility = currentSection[row];\n\n            // Set the cell's new visibility state\n            if (currentCell && currentCell.setVisibility) {\n              currentCell.setVisibility(currentCellVisibility);\n            }\n          }\n        }\n      }\n    }\n\n    // set visible rows visible, see https://github.com/sghiassy/react-native-sglistview/issues/12\n    for (const section in visibleRows) {\n      if (visibleRows.hasOwnProperty(section)) { // Good JS hygiene check\n        const currentSection = visibleRows[section];\n\n        for (const row in currentSection) {\n          if (currentSection.hasOwnProperty(row)) { // Good JS hygiene check\n            const currentCell = cellData[section][row];\n\n            // Set the cell visible\n            if (currentCell && currentCell.setVisibility) {\n              currentCell.setVisibility(true);\n            }\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Calculate and return the cell dimensions for the given cell (position and size)\n   */\n  calculateDimensionsForCell(cellData, childFrames, sectionID, rowID, horizontal, index) {\n    const row = cellData[sectionID];\n    if (!row) {\n      throw new Error(`sectionID not found ${sectionID}`);\n    }\n    const cell = row[rowID];\n    if (!cell) {\n      throw new Error(`rowID not found ${rowID}`);\n    }\n    let x = 0;\n    let y = 0;\n\n    const width = cell.viewProperties.width;\n    const height = cell.viewProperties.height;\n    if (childFrames.length) {\n      const childFrame = childFrames[childFrames.length - 1];\n      if (horizontal) {\n        x = childFrame.x + childFrame.width;\n      } else {\n        y = childFrame.y + childFrame.height;\n      }\n    }\n    return { x, y, width, height, index };\n  },\n\n  /**\n   * When the user is scrolling up or down - load the cells in the future to make it\n   * so the user doesn't see any flashing\n   */\n  updateCellsPremptively(props, cellData, visibleRows) {\n    if (!props.premptiveLoading) {\n      return; // No need to run is preemptive loading is 0 or false\n    }\n\n    if (!cellData.premptiveLoadedCells) {\n      cellData.premptiveLoadedCells = [];\n    }\n\n    // Get the first and last visible rows\n    let firstVisibleRow;\n    let lastVisibleRow;\n    let firstVisibleSection;\n    let lastVisibleSection;\n\n    for (const section in visibleRows) {\n      if (visibleRows.hasOwnProperty(section)) { // Good JS hygiene check\n        for (const row in visibleRows[section]) {\n          if (firstVisibleRow === undefined) {\n            firstVisibleSection = section;\n            firstVisibleRow = Number(row);\n          } else {\n            lastVisibleSection = section;\n            lastVisibleRow = Number(row);\n          }\n\n          /*\n           * Dont consider a cell preemptiveloaded if it is touched by default visibility logic.\n           */\n          const currentCell = cellData[section][row];\n          if (cellData.premptiveLoadedCells) {\n            const i = cellData.premptiveLoadedCells.indexOf(currentCell);\n            if (i >= 0) {\n              cellData.premptiveLoadedCells.splice(i, 1);\n            }\n          }\n        }\n      }\n    }\n\n    // Figure out if we're scrolling up or down\n    const isScrollingUp = cellData.firstVisibleRow > firstVisibleRow;\n    const isScrollingDown = cellData.lastVisibleRow < lastVisibleRow;\n\n    let scrollDirectionChanged;\n    if (isScrollingUp && cellData.lastScrollDirection === 'down') {\n      scrollDirectionChanged = true;\n    } else if (isScrollingDown && cellData.lastScrollDirection === 'up') {\n      scrollDirectionChanged = true;\n    }\n\n    // remove the other side's preemptive cells\n    if (scrollDirectionChanged) {\n      let cell = cellData.premptiveLoadedCells.pop();\n\n      while (cell != undefined) {\n        cell.setVisibility(false);\n        cell = cellData.premptiveLoadedCells.pop();\n      }\n    }\n\n    // Preemptively set cells\n    for (let i = 1; i <= props.premptiveLoading; i++) {\n      let cell;\n\n      if (isScrollingUp) {\n        cell = cellData[firstVisibleSection][firstVisibleRow - i];\n      } else if (isScrollingDown) {\n        cell = cellData[lastVisibleSection][lastVisibleRow + i];\n      }\n\n      if (cell) {\n        cell.setVisibility(true);\n        cellData.premptiveLoadedCells.push(cell);\n      } else {\n        break;\n      }\n    }\n\n    cellData.firstVisibleRow = firstVisibleRow; // cache the first seen row\n    cellData.lastVisibleRow = lastVisibleRow; // cache the last seen row\n\n    if (isScrollingUp) {\n      cellData.lastScrollDirection = 'up';\n    } else if (isScrollingDown) {\n      cellData.lastScrollDirection = 'down';\n    }\n  },\n};\n\n\nconst SGListView = React.createClass({\n\n  /**\n   * Object Lifecycle Methods\n   */\n\n  propTypes: {\n    // Default the propTypes to those as specified by ListView\n    ...ListView.propTypes,\n\n    /**\n     * OVERRIDE LISTVIEW's DEFAULT VALUE: Made component not required, since SGListView will provide one by default\n     *\n     * (props) => renderable\n     *\n     * A function that returns the scrollable component in which the list rows\n     * are rendered. Defaults to returning a ScrollView with the given props.\n     */\n    renderScrollComponent: React.PropTypes.func,\n\n    /**\n     * Number of cells to preeptively render in front of the users scrolling\n     */\n    premptiveLoading: PropTypes.number,\n  },\n\n  getDefaultProps() {\n    return {\n      premptiveLoading: 2,\n    };\n  },\n\n  /**\n   * View Lifecycle Methods\n   */\n\n  componentWillMount() {\n    // This object keeps track of the cell data.\n    // NOTE: We don't want to trigger a render pass when updating the data here\n    //       so we don't store this information in this.state.\n    this.cellData = {\n      lastVisibleRow: 0, // keep track of the last row rendered\n    };\n  },\n\n  onChangeVisibleRows(visibleRows, changedRows) {\n    // Update cell visibibility per the changedRows\n    PrivateMethods.updateCellsVisibility(this.cellData, visibleRows, changedRows);\n\n    // Premepty show rows to avoid onscreen flashes\n    PrivateMethods.updateCellsPremptively(this.props, this.cellData, visibleRows);\n\n    // If the user supplied an onChangeVisibleRows function, then call it\n    if (this.props.onChangeVisibleRows) {\n      this.props.onChangeVisibleRows(visibleRows, changedRows);\n    }\n  },\n\n  onScroll(e) {\n    // onChangeVisibleRows not sent on windows and android; work around this\n    if (Platform.OS !== 'ios') {\n      const childFrames = [];\n      const { dataSource, horizontal } = this.props;\n      const allRowIDs = dataSource.rowIdentities;\n      try {\n        let idx = 0;\n        for (let sectionIdx = 0; sectionIdx < allRowIDs.length; sectionIdx++) {\n          const sectionID = dataSource.sectionIdentities[sectionIdx];\n          const rowIDs = allRowIDs[sectionIdx];\n\n          if (this.props.renderSectionHeader) {\n            childFrames.push(PrivateMethods.calculateDimensionsForCell(this.cellData, childFrames, sectionID, 'dummy', horizontal, idx++));\n          }\n          for (let rowIdx = 0; rowIdx < rowIDs.length; rowIdx++) {\n            childFrames.push(PrivateMethods.calculateDimensionsForCell(this.cellData, childFrames, sectionID, rowIDs[rowIdx], horizontal, idx++));\n          }\n        }\n      } catch (ex) {\n          // do nothing. This is expected\n      }\n      // This code is a workaround which unfortunately depends upon calling a private method of the native list view.\n      this.getNativeListView()._updateVisibleRows(childFrames); // eslint-disable-line no-underscore-dangle\n    }\n    if (this.props.onScroll) {\n      this.props.onScroll(e);\n    }\n  },\n\n  getNativeListView() {\n    return this.refs.nativeListView;\n  },\n\n  // https://github.com/sghiassy/react-native-sglistview/issues/14\n  getScrollResponder() {\n    return this.refs.nativeListView.getScrollResponder();\n  },\n\n  /**\n   * Render Methods\n   */\n\n  renderScrollComponent(props) {\n    let component;\n\n    if (props.renderScrollComponent) {\n      component = props.renderScrollComponent(props);\n    } else {\n      component = (\n        <ScrollView {...props} />\n      );\n    }\n\n    return component;\n  },\n\n  // todo this needs to completely represent list view api\n  renderRow(rowData, sectionID, rowID, highlightRowFunc) {\n    // Get the user's view\n    const view = this.props.renderRow(rowData, sectionID, rowID, highlightRowFunc);\n\n    // Wrap the user's view in a SGListViewCell for tracking & performance\n    return (\n      <SGListViewCell\n        usersView={view}\n        ref={(row) => {\n          // Capture a reference to the cell on creation\n          // We have to do it this way for ListView: https://github.com/facebook/react-native/issues/897\n          PrivateMethods.captureReferenceFor(this.cellData, sectionID, rowID, row);\n        }} />\n    );\n  },\n\n  renderSectionHeader(sectionData, sectionID) {\n    const sectionHeaderSupplied = this.props.renderSectionHeader != undefined;\n\n    if (!sectionHeaderSupplied) {\n      return null;\n    }\n\n    const view = this.props.renderSectionHeader(sectionData, sectionID);\n    return (\n      <SGListViewCell\n        usersView={view}\n        ref={(section) => {\n          // Capture a reference to the cell on creation\n          // We have to do it this way for ListView: https://github.com/facebook/react-native/issues/897\n          PrivateMethods.captureReferenceFor(this.cellData, sectionID, 'dummy', section);\n        }} />\n      );\n  },\n\n  render() {\n    return (\n      <ListView\n        {...this.props}\n        ref=\"nativeListView\"\n        renderScrollComponent={this.renderScrollComponent}\n        renderRow={this.renderRow}\n        renderSectionHeader={this.renderSectionHeader}\n        onChangeVisibleRows={this.onChangeVisibleRows}\n        onScroll={this.onScroll} />\n    );\n  },\n});\n\nmodule.exports = SGListView;\n"]}